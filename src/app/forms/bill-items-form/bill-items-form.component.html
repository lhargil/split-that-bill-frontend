<form *ngIf="billItemsForm" [formGroup]="billItemsForm">
  <div class="mb-4">
    <em class="text-red-500 text-sm">
      * Discounts are in unit price units
    </em>
  </div>
  <div formArrayName="billItems" *ngFor="let billItem of billItems.controls; let i = index;">
    <div class="mb-4" [formGroupName]="i">
      <div class="flex flex-col md:flex-row items-start md:items-center mx-2">
        <span class="mr-2">1</span>
        <input class="field-input-text focus:outline-none focus:shadow-outline my-2 mr-2"
          [ngClass]="{'border border-red-500 focus:shadow-none': billItems.controls[i].get('description').invalid && (billItems.controls[i].get('description').dirty || billItems.controls[i].get('description').touched)}"
          type="text" formControlName="description" placeholder="Description" />
        <div class="flex items-center justify-between mx-1 my-2">
          <input class="field-input-text w-1/2 focus:outline-none focus:shadow-outline -ml-1"
            [ngClass]="{'border border-red-500 focus:shadow-none': billItems.controls[i].get('amount').invalid && (billItems.controls[i].get('amount').dirty || billItems.controls[i].get('amount').touched)}"
            type="text" formControlName="amount" placeholder="Amount" />
          <input class="field-input-text w-1/2 focus:outline-none focus:shadow-outline -mr-1"
            [ngClass]="{'border border-red-500 focus:shadow-none': billItems.controls[i].get('discount').invalid && (billItems.controls[i].get('discount').dirty || billItems.controls[i].get('discount').touched)}"
            type="text" formControlName="discount" placeholder="Discount" />
        </div>
        <div class="flex-1 flex items-center justify-between md:mx-2">
          <button
            class="flex-1 bg-transparent text-green-700 font-semibold hover:text-white py-2 px-4 hover:bg-green-500 hover:border-transparent rounded inline-flex items-center justify-center"
            type="button" (click)="addBillItem()">
            <svg class="fill-current h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
              <path d="M11 9V5H9v4H5v2h4v4h2v-4h4V9h-4zm-1 11a10 10 0 1 1 0-20 10 10 0 0 1 0 20z" /></svg>
          </button>
          <button
            class="flex-1 text-red-700 font-bold py-2 px-4 rounded inline-flex items-center justify-center hover:bg-red-500 hover:text-white"
            type="button" (click)="removeBillItem(i)">
            <svg class="fill-current h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
              <path d="M6 2l2-2h4l2 2h4v2H2V2h4zM3 6h14l-1 14H4L3 6zm5 2v10h1V8H8zm3 0v10h1V8h-1z" /></svg>

          </button>
        </div>
      </div>
      <div
        *ngIf="billItems.controls[i].get('description').invalid && (billItems.controls[i].get('description').dirty || billItems.controls[i].get('description').touched)"
        class="field-error mx-2">
        <div *ngIf="billItems.controls[i].get('description').errors.required">
          Description {{i + 1}} is required.
        </div>
        <div *ngIf="billItems.controls[i].get('description').errors.minlength">
          Description {{i + 1}} must be at least 3 characters long.
        </div>
      </div>
      <div class="field-error"
        *ngIf="billItems.controls[i].get('amount').invalid && (billItems.controls[i].get('amount').dirty || billItems.controls[i].get('amount').touched)">
        <div *ngIf="billItems.controls[i].get('amount').errors.required">
          Amount {{i + 1}} is required.
        </div>
        <div *ngIf="billItems.controls[i].get('amount').errors.notDecimal">
          Amount {{i + 1}} must be in decimal format.
        </div>
      </div>
      <div class="field-error"
        *ngIf="billItems.controls[i].get('discount').invalid && (billItems.controls[i].get('discount').dirty || billItems.controls[i].get('discount').touched)">
        Discount {{i + 1}} must be in decimal format.
      </div>
    </div>
  </div>
</form>
